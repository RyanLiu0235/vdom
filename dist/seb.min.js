!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.seb=t()}(this,function(){"use strict";var e=function e(t,n,r){n=n||{},r=r||[],this.tagName=t,this.props=n,this.key=n.key,this.children=r;for(var i,o=0,a=0;a<r.length;a++)(i=r[a])instanceof e&&(o+=i.count),o++;this.count=o};var t=function e(t){for(var n,r,i=document.createElement(t.tagName),o=t.props,a=Object.keys(o),f=0;f<a.length;f++)"function"==typeof(r=o[n=a[f]])?n in i&&(i[n]=r):i.setAttribute(n,r);for(var s,c=t.children,u=0;u<c.length;u++)if(s=c[u],["string","number"].indexOf(typeof s)>-1){var h=document.createTextNode(s);i.appendChild(h)}else{var p=e(s);i.appendChild(p)}return i};function n(e,t){for(var n={},i=[],o=0,a=e.length;o<a;o++){var f=e[o],s=r(f,t);s?n[s]=o:i.push(f)}return{keyIndex:n,free:i}}function r(e,t){if(e&&t)return"string"==typeof t?e[t]:t(e)}var i={makeKeyIndexAndFree:n,diff:function(e,t,i){for(var o,a,f=n(e,i),s=n(t,i),c=s.free,u=f.keyIndex,h=s.keyIndex,p=[],l=[],d=0,v=0;d<e.length;){if(a=r(o=e[d],i))if(h.hasOwnProperty(a)){var y=h[a];l.push(t[y])}else l.push(null);else{var g=c[v++];l.push(g||null)}d++}var m=l.slice(0);for(d=0;d<m.length;)null===m[d]?(O(d),P(d)):d++;for(var E=d=0;d<t.length;){a=r(o=t[d],i);var R=m[E],k=r(R,i);R?a===k?E++:u.hasOwnProperty(a)&&r(m[E+1],i)===a?(O(d),P(E),E++):b(d,o):b(d,o),d++}function O(e){var t={index:e,type:0};p.push(t)}function b(e,t){var n={index:e,item:t,type:1};p.push(n)}function P(e){m.splice(e,1)}return{moves:p,children:l}}}.diff,o={isString:function(e){return"string"==typeof e}},a={REPLACE:"REPLACE",REORDER:"REORDER",PROPS:"PROPS",TEXT:"TEXT"};function f(e,n){var r=n.patch;switch(n.type){case a.REPLACE:var i=o.isString(r)?r:t(r);e.parentNode.replaceChild(i,e);break;case a.REORDER:!function(e,n){for(var r,i,o,a,f=e.childNodes,s=0;s<n.length;s++)switch(r=n[s],i=r.index,o=r.item,a=f[i],r.type){case 0:e.removeChild(a);break;case 1:var c=t(o);e.insertBefore(c,a)}}(e,r.moves);break;case a.PROPS:!function(e,t){for(var n,r,i=Object.keys(t),o=0;o<i.length;o++)n=i[o],"function"==typeof(r=t[n])||(!1===r||void 0===r?e.removeAttribute(n):e.setAttribute(n,r))}(e,r);break;case a.TEXT:var f=document.createTextNode(r);e.parentNode.replaceChild(f,e)}}return{h:function(t,n,r){return new e(t,n,r)},render:t,diff:function(e,t){var n={};return function e(t,n,r,f){var s=[];if(null===n);else if(o.isString(t)&&o.isString(n))t!==n&&s.push({type:a.TEXT,patch:n});else if(t.tagName===n.tagName&&t.key===n.key){for(var c,u=t.props,h=n.props,p=Object.assign({},u,h),l=Object.keys(p),d={},v=0;v<l.length;v++)c=l[v],h[c]!==u[c]&&(d[c]=h[c]);Object.keys(d).length>0&&s.push({type:a.PROPS,patch:d});var y=t.children,g=i(y,n.children,"key"),m=g.moves,E=g.children;m.length>0&&s.push({type:a.REORDER,patch:{moves:m}});for(var R,k,O=null,b=r,P=0;P<y.length;P++)R=y[P],k=E[P],b+=O&&O.count?O.count:1,e(R,k,b,f),O=R}else s.push({type:a.REPLACE,patch:n});s.length>0&&(f[r]=s)}(e,t,0,n),n},patch:function(e,t){!function e(t,n,r){var i=n[r];if(!o.isString(t))for(var a=t.childNodes,s=0;s<a.length;s++)e(a[s],n,++r);if(i)for(var c=0;c<i.length;c++)f(t,i[c])}(e,t,0)}}});
